/* UPDATE 4.8.0.0*/

SET SEARCH_PATH = "COMMON";

UPDATE "Variable" SET "VALUE" = '4.8.0.0' WHERE "NAME" = 'COMMON_DB_VERSION';

SET SEARCH_PATH = "0001";

CREATE TABLE "Ayuda" 
( 
	"OID" bigserial NOT NULL,
	"SERIAL" int8 DEFAULT 0 NOT NULL,
	"CODIGO" varchar(255),
	"ESTADO" int8 DEFAULT 10,
	"NOMBRE" varchar(255),
	"CUENTA_CONTABLE" varchar(255),
	"OBSERVACIONES" text,
	CONSTRAINT "PK_Ayuda" PRIMARY KEY ("OID")
) WITHOUT OIDS;

ALTER TABLE "Ayuda" OWNER TO moladmin;
GRANT ALL ON TABLE "Ayuda" TO GROUP "MOLEQULE_ADMINISTRATOR";

CREATE TABLE "AyudaPeriodo" 
( 
	"OID" bigserial NOT NULL,
	"OID_AYUDA" bigserial NOT NULL,
	"ESTADO" int8 DEFAULT 10,
	"TIPO_DESCUENTO" bigint DEFAULT 2,
	"PORCENTAJE" decimal(10,2) DEFAULT 0,
	"CANTIDAD" decimal(10,5) DEFAULT 0,
	"FECHA_INI" timestamp without time zone,
	"FECHA_FIN" timestamp without time zone,
	"OBSERVACIONES" text,
	CONSTRAINT "PK_AyudaPeriodo" PRIMARY KEY ("OID")
) WITHOUT OIDS;

ALTER TABLE "AyudaPeriodo" OWNER TO moladmin;
GRANT ALL ON TABLE "AyudaPeriodo" TO GROUP "MOLEQULE_ADMINISTRATOR";

ALTER TABLE "AyudaPeriodo" ADD CONSTRAINT "FK_AyudaPeriodo_Ayuda" FOREIGN KEY ("OID_AYUDA") REFERENCES "Ayuda" ("OID") ON UPDATE CASCADE ON DELETE CASCADE;

INSERT INTO "Ayuda" ("SERIAL", "CODIGO", "ESTADO", "NOMBRE") VALUES (1, '001', 10, 'REA');
INSERT INTO "Ayuda" ("SERIAL", "CODIGO", "ESTADO", "NOMBRE") VALUES (2, '002', 10, 'POSEI');
INSERT INTO "Ayuda" ("SERIAL", "CODIGO", "ESTADO", "NOMBRE") VALUES (3, '003', 10, 'FOMENTO');
INSERT INTO "AyudaPeriodo" ("OID_AYUDA", "ESTADO", "TIPO_DESCUENTO", "PORCENTAJE", "CANTIDAD", "FECHA_INI", "FECHA_FIN") VALUES (3, 10, 2, 50, 0, '2011/01/01', '2011/01/31');
INSERT INTO "AyudaPeriodo" ("OID_AYUDA", "ESTADO", "TIPO_DESCUENTO", "PORCENTAJE", "CANTIDAD", "FECHA_INI", "FECHA_FIN") VALUES (3, 10, 2, 50, 0, '2012/01/01', '2012/01/31');

ALTER SEQUENCE "Ayuda_OID_seq" RESTART WITH 2;
